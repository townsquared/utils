"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}angular.module("ts.utils",[]),angular.module("ts.utils").directive("uiEvent",function($parse){return{priority:100,link:function($scope,$elm,$attrs){var events=$scope.$eval($attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);$elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}}),angular.module("ts.utils").filter("ts-truncate",function(){return function(value){var wordLimit=arguments.length<=1||void 0===arguments[1]?50:arguments[1],ellipses=arguments.length<=2||void 0===arguments[2]?"â€¦":arguments[2];if(!value)return value;var words=value.split(" ");return words.length>wordLimit&&(value=words.slice(0,wordLimit).join(" "),ellipses&&(value+=ellipses)),value}}),angular.module("ts.utils").directive("scrollOn",function($timeout){return{link:{pre:function($scope,$element,$attrs){$scope.$on($attrs.scrollOn,function(event,location){$timeout(function(){$element[0].scrollTop="bottom"===location?$element[0].scrollHeight:"top"===location?0:location},!0)})}}}});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();angular.module("ts.utils").factory("Paginator",function($http,$q){var Paginator=function(){function Paginator(paginate){var options=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],relatedHelpers=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];_classCallCheck(this,Paginator),this.resetOptions=options,this.paginate=paginate,this.relatedHelpers=relatedHelpers,this.related=_.mapValues(this.relatedHelpers,function(){return{}})}return _createClass(Paginator,[{key:"reset",value:function(){var resetOptions=arguments.length<=0||void 0===arguments[0]?this.resetOptions:arguments[0];return this.resetOptions=resetOptions,this.options=_.extend({limit:40,offset:0,page:0},resetOptions),this.hasMore=!0,this.items=[],this}},{key:"add",value:function(item){return this.items.unshift(item),this.getRelated([item])}},{key:"remove",value:function(item){this.items[item]||(item=this.items.indexOf(item)),~item&&this.items.splice(item,1)}},{key:"next",value:function(){var _this=this;return this.hasMore?this.loading?this.loading:this.loading=this.paginate(this.options).then(function(items){return items.length||(_this.hasMore=!1),_this.items=_this.items.concat(items.reverse()),_this.items=_.uniq(_this.items,"uuid"),_this.options.page++,_this.options.offset=_this.options.page*_this.options.limit,_this.getRelated(items)}).then(function(related){return _this.items})["finally"](function(){return _this.loading=null}):$q.when(this.items)}},{key:"getRelated",value:function(){var _this2=this,items=arguments.length<=0||void 0===arguments[0]?this.items:arguments[0];return $q.all(_.mapValues(this.relatedHelpers,function(helper,name){return helper(items).then(function(relatedItems){return _.extend(_this2.related[name],relatedItems)})}))}},{key:"paginate",set:function(paginate){this.reset(),this._paginate=angular.isString(paginate)?function(paginateOptions){return $http.get(paginate,{params:paginateOptions})}:paginate},get:function(){return this._paginate}}]),Paginator}();return Paginator}),angular.module("ts.utils").directive("focusOn",function(){return{link:function($scope,$element,$attrs){var listener=angular.noop;$attrs.$observe("focusOn",function(newVal){listener(),listener=$scope.$on(newVal,function(){$element[0].focus()})})}}}),angular.module("ts.utils").directive("autoGrow",function($timeout){return{restrict:"A",link:function($scope,$element,$attrs){function grow(){$element[0].style.height=0,$element[0].style.height=$element[0].scrollHeight+"px"}$element.on("input",grow),$timeout(grow,!0)}}});
//# sourceMappingURL=utils.min.js.map